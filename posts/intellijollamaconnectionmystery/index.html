<!doctype html><html lang=en><head><title>When Curl Works But IntelliJ Doesn’t: The Ollama Connection Mystery :: The Tymscar Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="IntelliJ kept saying “Failed to connect” to my Ollama instance while curl worked perfectly. Here’s what actually broke and the one-line fix."><meta name=keywords content="macOS,development,jetbrains,debugging,networking"><meta name=robots content="noodp"><link rel=canonical href=/posts/intellijollamaconnectionmystery/><link rel=stylesheet href=/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=/style.css><link rel="shortcut icon" href=/img/favicon/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content="google.com"><meta name=twitter:creator content="tymscar"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="When Curl Works But IntelliJ Doesn’t: The Ollama Connection Mystery"><meta property="og:description" content="IntelliJ kept saying “Failed to connect” to my Ollama instance while curl worked perfectly. Here’s what actually broke and the one-line fix."><meta property="og:url" content="/posts/intellijollamaconnectionmystery/"><meta property="og:site_name" content="The Tymscar Blog"><meta property="og:image" content="/intellijOllamaConnectivity/failed-to-connect.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2025-09-05 12:00:00 +0000 UTC"><img src=https://librecounter.tymscar.com/counter.svg referrerpolicy=unsafe-url width=0 height=0 alt loading=eager decoding=async style=display:none;border:none;outline:none;margin:0;padding:0></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Tymscar</div></a></div></div></header><div class=content><article class=post><h1 class=post-title><a href=/posts/intellijollamaconnectionmystery/>When Curl Works But IntelliJ Doesn’t: The Ollama Connection Mystery</a></h1><div class=post-meta><time class=post-date>2025-09-05</time><span class=post-author>Oscar Molnar</span><span class=post-reading-time>3 min read (599 words)</span></div><span class=post-tags>#<a href=/tags/macos/>macOS</a>&nbsp;
#<a href=/tags/development/>development</a>&nbsp;
#<a href=/tags/jetbrains/>jetbrains</a>&nbsp;
#<a href=/tags/debugging/>debugging</a>&nbsp;
#<a href=/tags/networking/>networking</a>&nbsp;</span><div class=post-content><div><p>I run a bunch of internal services through Traefik on my LAN, each with a proper domain name and TLS, so I don’t have to remember ports. One of them is Ollama, sitting on a beefy gaming PC at <code>10.0.0.105</code> and exposed as <code>https://ollama.tymscar.com</code>. From the terminal everything behaved exactly as expected: fast responses, certificate valid, models listed. Then IntelliJ IDEA decided this host basically didn’t exist. The “Test Connection” button just said “Failed to connect”. No detail. No hint. Just a smug little red failure.</p><p><img src=/intellijOllamaConnectivity/failed-to-connect.png alt="Failed connection dialog"></p><p>Meanwhile:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s https://ollama.tymscar.com/api/tags | jq <span style=color:#e6db74>&#39;.models[].name&#39;</span> | head -n <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;gpt-oss:20b&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;llama3:8b-instruct-fp16&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;qwen3:32b&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Supa-AI/mixtral-8x7b-instruct-v0.1:q4_k_m&#34;</span>
</span></span></code></pre></div><p>And the plain internal HTTP endpoint (skipping Traefik entirely) also worked:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s http://10.0.0.105:11434/api/tags | jq <span style=color:#e6db74>&#39;.models[].name&#39;</span> | head -n <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;gpt-oss:20b&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;llama3:8b-instruct-fp16&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;qwen3:32b&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Supa-AI/mixtral-8x7b-instruct-v0.1:q4_k_m&#34;</span>
</span></span></code></pre></div><p>So networking, DNS, TLS termination, Ollama itself: all fine.</p><h2 id=false-start-1-maybe-intellij-just-doesnt-support-https-here>False Start #1: “Maybe IntelliJ just doesn’t support HTTPS here”<a href=#false-start-1-maybe-intellij-just-doesnt-support-https-here class=hanchor arialabel=Anchor>#</a></h2><p>Not a wild idea. I’d already hit a similar limitation months before with Raycast’s Ollama support. I even tweeted about it at the time. Raycast was hardcoded to use plain HTTP for Ollama, so when I tried an HTTPS homelab endpoint it mangled the URL into something like <code>http://https://myDomain</code> and App Transport Security then blocked the non-local HTTP fallback. So the idea that IntelliJ might also just not support the HTTPS reverse-proxied variant first didn’t feel far-fetched.</p><p><img src=/intellijOllamaConnectivity/raycast-tweet.png alt="Old Raycast HTTPS issue tweet"></p><p>So I bypassed Traefik completely and pointed IntelliJ straight at <code>http://10.0.0.105:11434</code>. Exact same failure dialog. So not HTTPS.</p><h2 id=false-start-2-macos-local-network-permission>False Start #2: “macOS local network permission?”<a href=#false-start-2-macos-local-network-permission class=hanchor arialabel=Anchor>#</a></h2><p>Checked System Settings > Privacy & Security > Local Network. IntelliJ was already allowed. Nothing to toggle. Still failed.</p><h2 id=false-start-3-firewall>False Start #3: “Firewall?”<a href=#false-start-3-firewall class=hanchor arialabel=Anchor>#</a></h2><p>macOS firewall off. No third‑party blocker. Another dead end.</p><p>At this point the pattern was clear: <strong>if curl works to both the domain and the raw IP:port, and an IDE insists it can’t connect, the problem is very likely inside the JVM layer, not the network.</strong></p><h2 id=looking-at-the-logs>Looking at the logs<a href=#looking-at-the-logs class=hanchor arialabel=Anchor>#</a></h2><p>The UI was useless, so I opened:</p><pre tabindex=0><code>~/Library/Logs/JetBrains/IntelliJIdea2025.2/idea.log
</code></pre><p>There it was:</p><pre tabindex=0><code>Failed to connect to Ollama @ http://10.0.0.105:11434/: java.net.ConnectException: No route to host
</code></pre><p>Important detail: that error is from the direct HTTP attempt, no Traefik, no TLS. <code>No route to host</code> when the host clearly routes fine for other processes usually screams: address family / IPv6 oddity / JVM fallback behavior.</p><h2 id=what-was-really-happening>What was really happening<a href=#what-was-really-happening class=hanchor arialabel=Anchor>#</a></h2><p><code>curl</code> happily talks IPv4 to <code>10.0.0.105</code>. The JVM, however, was trying (or initializing toward) an IPv6 path first and not gracefully falling back, ending in “No route to host”. The LAN here is plain IPv4; there’s nothing meaningful for that IPv6 attempt to succeed with, so the connection attempt just died before any IPv4 retry happened.</p><h2 id=the-one-line-fix>The one-line fix<a href=#the-one-line-fix class=hanchor arialabel=Anchor>#</a></h2><p>In IntelliJ:</p><pre tabindex=0><code>Help &gt; Edit Custom VM Options…
</code></pre><p>Add:</p><pre tabindex=0><code>-Djava.net.preferIPv4Stack=true
</code></pre><p>Save and restart.</p><p>After restart: both <code>http://10.0.0.105:11434</code> and <code>https://ollama.tymscar.com</code> connected instantly in the Test Connection dialog. Same configuration, nothing changed on Traefik or the host.</p><p><img src=/intellijOllamaConnectivity/successful-connection.png alt="Successful connection after adding IPv4 flag"></p><h2 id=why-that-works>Why that works<a href=#why-that-works class=hanchor arialabel=Anchor>#</a></h2><p>That flag disables the IPv6 stack for that JVM instance and forces straight IPv4 usage. Remove the early failing path, remove the misleading error. HTTPS “magically” working afterwards wasn’t magic (it was never a TLS problem), it just never got far enough previously to prove that.</p><p>(If someone wanted a softer approach they could try <code>-Djava.net.preferIPv4Addresses=true</code>, but I didn’t need nuance here.)</p><h2 id=final-thoughts>Final thoughts<a href=#final-thoughts class=hanchor arialabel=Anchor>#</a></h2><p>I almost went down the rabbit hole of tweaking Traefik rules, reissuing certificates, or inventing a phantom permissions problem. The log had the answer the whole time. If a Java GUI refuses to reach something that <code>curl</code> clearly can, check its logs immediately and consider IPv6 preference issues before dismantling half your stack.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><a href=/posts/wifi7speedhunt/ class="button inline prev">&lt; [<span class=button__text>From 400 Mbps to 1.7 Gbps: A WiFi 7 Debugging Journey</span>]
</a>::
<a href=/posts/yubicowashingmachine/ class="button inline next">[<span class=button__text>I washed my Yubikey twice by accident. Here's how I saved it both times.</span>] ></a></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>